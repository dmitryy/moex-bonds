{"version":3,"sources":["context/MoexBondsReducer.js","store/actions/ActionTypes.js","context/MoexBondsContext.js","utils/mapper.js","api/moex.js","context/MoexBondsProvider.js","components/BondsTable/BondTableRow.js","components/BondsTable/BondTableHead.js","components/BondsTable/Columns.js","components/BondsTable/SortUtils.js","components/BondsTable/StyleUtils.js","components/BondsTable/BondsTable.js","components/Bonds/Bonds.js","common/months.js","components/Filter/Filter.js","components/PortfolioItem/PortfolioItem.js","components/Portfolio/Portfolio.js","components/Chart/Chart.js","components/ChartCumulative/ChartCumulative.js","pages/Home.js","App.js","serviceWorker.js","index.js"],"names":["handlers","state","action","initialBonds","payload","bonds","loading","boards","filter","portfolio","MoexBondsReducer","type","DEFAULT","MoexBondsContext","React","createContext","convertArrayToObject","arr","columns","obj","forEach","col","index","mapResponseToBonds","securities","map","bond","value","returnValue","name","SHORTNAME","price","PREVPRICE","expireDate","MATDATE","BUYBACKDATE","coupon","COUPONVALUE","couponPeriod","COUPONPERIOD","couponPercent","YIELDATPREVWAPRICE","couponDate","NEXTCOUPON","couponAccumulated","ACCRUEDINT","couponCount","calculateCouponCount","currency","FACEUNIT","LOTVALUE","BUYBACKPRICE","board","BOARDID","isin","ISIN","months","calculateCouponMonths","console","log","couponDateStr","expireDateStr","period","Date","paysPerYear","Math","floor","Object","keys","length","getMonth","setDate","getDate","m","parseInt","round","moexBondsUrl","getBonds","a","axios","get","response","data","MoexBondsProvider","children","useReducer","currencies","month","dispatch","setLoading","getMoexBonds","getFilteredBonds","concat","includes","Provider","setFilter","setPortfolio","BondTableRow","props","row","TableRow","hover","TableCell","key","id","align","numeric","template","BondTableHead","classes","order","orderBy","onRequestSort","TableHead","headCell","padding","disablePadding","sortDirection","TableSortLabel","active","direction","onClick","property","event","label","className","visuallyHidden","descendingComparator","b","useStyles","makeStyles","theme","root","width","paper","marginBottom","spacing","table","minWidth","border","clip","height","margin","overflow","position","top","BondsTable","useState","setOrder","setOrderBy","page","setPage","rowsPerPage","setRowsPerPage","rows","Fragment","TableContainer","Table","size","rowCount","TableBody","array","comparator","stabilizedThis","el","sort","stableSort","getComparator","slice","TablePagination","rowsPerPageOptions","component","count","onChangePage","newPage","onChangeRowsPerPage","target","Bonds","useContext","Link","href","modifiedPortfolio","portfolioItem","p","push","addBondToPortfolio","Filter","FormControl","InputLabel","Select","labelId","onChange","modifiedFilter","MenuItem","PortfolioItem","changeCount","removeItem","TextField","parseFloat","calculateCost","Portfolio","changedPortfolio","item","total","calculateTotal","Chart","portfolioMonths","maxCouponValue","getCouponValue","monthIndex","getBarHeightString","percent","items","calculateTotalCoupon","coupons","max","style","ChartCumulative","payments","returns","sortedBonds","curDate","curMonth","d1","d2","getFullYear","monthDiff","Array","i","nextMonths","indexOf","fromCurrent","monthDelta","j","inMonths","paymentsFiltered","reduce","acc","val","num","portfolioTotal","returnTotal","profit","profitPercent","drawReturns","splice","yearsCount","annualProfit","r","ret","Home","useEffect","App","Boolean","window","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.5e0f2623.chunk.js","sourcesContent":["import { \n    GET_ALL_BONDS, \n    SET_LOADING, \n    GET_ALL_BOARDS, \n    SET_FILTERED_BONDS, \n    SET_FILTER, \n    SET_PORTFOLIO\n} from \"../store/actions/ActionTypes\";\n\nconst handlers = {\n    [GET_ALL_BONDS]: (state, action) => ({ ...state, initialBonds: action.payload.initialBonds, \n        bonds: action.payload.bonds, loading: false }),\n    [GET_ALL_BOARDS]: (state, action) => ({ ...state, boards: action.payload, loading: false }),\n    [SET_LOADING]: (state) => ({ ...state, loading: true }),\n    [SET_FILTER]: (state, action) => ({ ...state, filter: action.payload.filter, \n        bonds: action.payload.bonds }),\n    [SET_FILTERED_BONDS]: (state, action) => ({ ...state, bonds: action.payload }),\n    [SET_PORTFOLIO]: (state, action) => ({ ...state, portfolio: action.payload }),\n    DEFAULT: state => state\n}\n\nexport const MoexBondsReducer = (state, action) => {\n    const handler = handlers[action.type] || handlers.DEFAULT;\n    return handler(state, action);\n}","export const GET_ALL_BONDS = 'GET_ALL_BONDS';\nexport const GET_ALL_BOARDS = 'GET_ALL_BOARDS';\n\nexport const SET_LOADING = 'SET_LOADING';\n\nexport const SET_FILTER = 'SET_FILTER';\nexport const SET_FILTERED_BONDS = 'SET_FILTERED_BONDS';\nexport const SET_PORTFOLIO = 'SET_PORTFOLIO';\n","import React from 'react';\n\nexport const MoexBondsContext = React.createContext();\n","/**\n * \n * @param {*} arr \n * @param {*} columns \n */\nconst convertArrayToObject = (arr, columns) => {\n    const obj = {};\n    \n    columns.forEach((col, index) => {\n        obj[col] = arr[index]\n    });\n\n    return obj;    \n}\n\n/**\n * \n * @param {*} boards \n * @param {*} columns \n */\nexport const mapResponseToBoards = (boards, columns) => {\n    return boards.map(board => {\n        return convertArrayToObject(board, columns)\n    });\n}\n\n/**\n * \n * @param {*} securities \n * @param {*} columns \n */\nexport const mapResponseToBonds = (securities, columns) => {\n    return securities.map(bond => {\n        \n        const value = convertArrayToObject(bond, columns);\n\n        const returnValue = {\n            name: value.SHORTNAME,\n            price: value.PREVPRICE,\n            expireDate: value.MATDATE != '0000-00-00' ? value.MATDATE : value.BUYBACKDATE,\n            coupon: value.COUPONVALUE,\n            couponPeriod: value.COUPONPERIOD,\n            couponPercent: value.YIELDATPREVWAPRICE, // value.COUPONPERCENT,\n            couponDate: value.NEXTCOUPON,\n            couponAccumulated: value.ACCRUEDINT, // НКД\n            couponCount: calculateCouponCount(value.NEXTCOUPON, value.MATDATE != '0000-00-00' ? value.MATDATE : value.BUYBACKDATE, value.COUPONPERIOD),\n            currency: value.FACEUNIT, // value.CURRENCYID,\n            value: value.MATDATE != '0000-00-00' ? value.LOTVALUE : value.BUYBACKPRICE, // BUYBACKPRICE\n            board: value.BOARDID,\n            isin: value.ISIN,\n\n            // months that coupon paid, starting from 1 till 12\n            months: calculateCouponMonths(value.NEXTCOUPON, value.MATDATE, value.COUPONPERIOD),\n            // expire days\n            //expireDays: calculateExpireDays(value.MATDATE)\n        };\n\n        if (bond[2] === 'ФинАвиа 01') {\n            console.log(value)\n            console.log(returnValue)\n        }\n        // if (returnValue.isin == 'RU000A0JXE06') {\n        //     console.log('RU000A0JXE06', returnValue);\n        // }\n        // if (bond[2] === 'RUS-28') {\n        //     console.log(value)\n        //     console.log(returnValue)\n        // }\n\n        return returnValue;\n    });\n}\n\n/**\n * Returns array of month with coupon paind, starting from 1 till 12\n * @param {*} couponDateStr \n * @param {*} expireDateStr \n * @param {*} period \n */\nconst calculateCouponMonths = (couponDateStr, expireDateStr, period) => {\n    let couponDate = new Date(couponDateStr);\n    let expireDate = new Date(expireDateStr);\n    let months = {};\n    let paysPerYear = Math.floor(368 / period);\n\n    while (couponDate <= expireDate && Object.keys(months).length < paysPerYear) {\n        months[couponDate.getMonth() + 1] = couponDate;\n        couponDate.setDate(couponDate.getDate() + period);\n    }\n\n    return Object.keys(months).map(m => parseInt(m));\n}\n\nconst calculateExpireDays = (expireDateStr) => {\n    let expireDate = new Date(expireDateStr);\n    let currentDate = new Date();\n    let days = Math.round((expireDate - currentDate) / (1000 * 3600 * 24));\n    return days;\n}\n\nconst calculateCouponCount = (couponDateStr, expireDateStr, period) => {\n    let couponDate = new Date(couponDateStr);\n    let expireDate = new Date(expireDateStr);\n    return Math.round((expireDate - couponDate) / (1000 * 3600 * 24) / period + 1);\n}","import axios from 'axios';\nimport { mapResponseToBoards, mapResponseToBonds } from '../utils/mapper';\n\n/**\n * Moex boards documentation: http://ftp.moex.com/pub/ClientsAPI/ASTS/docs/ASTS_Markets_and_Boards.pdf\n */\nconst moexBaseUrl = 'http://iss.moex.com/iss';\nconst moexBoardsUrl = `${moexBaseUrl}/index.json`;\nconst moexBondsUrl = `${moexBaseUrl}/engines/stock/markets/bonds/securities.json`;\n\n/**\n * \n */\nexport const getBoards = async () => {\n    const response = await axios.get(moexBoardsUrl);\n    const columns = response.data.boards.columns;\n    const boards = response.data.boards.data;\n    return mapResponseToBoards(boards, columns);\n}\n\n/**\n * \n */\nexport const getBonds = async () => {\n    const response = await axios.get(moexBondsUrl);\n    const columns = response.data.securities.columns;\n    const securities =  response.data.securities.data;\n    return mapResponseToBonds(securities, columns);\n}","import React, { useReducer } from 'react'\nimport { MoexBondsReducer } from './MoexBondsReducer'\nimport { GET_ALL_BOARDS, GET_ALL_BONDS, SET_LOADING, SET_FILTERED_BONDS, SET_FILTER, SET_PORTFOLIO } from '../store/actions/ActionTypes';\nimport { MoexBondsContext } from './MoexBondsContext';\nimport { \n    getBonds as getMoexBonds, \n    getBoards as getMoexBoards\n} from '../api/moex';\n\nexport const MoexBondsProvider = ({children}) => {\n\n    const initialState = {\n        boards: [],\n        bonds: [],\n        filter: {\n            boards: ['TQOD', 'TQOB', 'TQCB'],\n            currencies: ['SUR'],\n            month: null,\n        },\n        initialBonds: [],\n        loading: false,\n        portfolio: []\n    }\n\n    const [state, dispatch] = useReducer(MoexBondsReducer, initialState);\n\n    /**\n     * get moex boards\n     */\n    const getBoards = async () => {\n        setLoading();\n\n        const boards = await getMoexBoards();\n\n        dispatch({\n            type: GET_ALL_BOARDS,\n            payload: boards\n        });\n    }\n\n    /**\n     * get moex bonds\n     */\n    const getBonds = async () => {\n        setLoading();\n        \n        const bonds = await getMoexBonds();\n\n        dispatch({\n            type: GET_ALL_BONDS,\n            payload: {\n                initialBonds: bonds,\n                bonds: getFilteredBonds(bonds, state.filter)\n            }\n        });\n    }\n\n    /**\n     * \n     * @param {object} filter - bonds filter\n     */\n    const setFilter = (filter) => {\n        dispatch({\n            type: SET_FILTER,\n            payload: {\n                filter: filter,\n                bonds: getFilteredBonds(state.initialBonds, filter)\n            }\n        });\n    }\n\n    /**\n     * get bonds according to filter set\n     */\n    const getFilteredBonds = (bonds, filter) => {\n        const boards = filter.boards;\n        const currencies = filter.currencies;\n        const month = filter.month;\n        const filteredBonds = bonds.concat().filter(bond => boards.includes(bond.board)\n            && currencies.includes(bond.currency)\n            && (!month || bond.months.includes(month))\n            && bond.price != null\n            && bond.coupon > 0\n        );\n        // console.log(bonds);\n        // console.log(bonds[1810])\n        // console.log(filteredBonds[238])\n        return filteredBonds;\n    }\n\n    /**\n     * set loading\n     */\n    const setLoading = () => {\n        dispatch({\n            type: SET_LOADING\n        })\n    }\n\n    /**\n     * \n     * @param {object} portfolio \n     */\n    const setPortfolio = (portfolio) => {\n        dispatch({\n            type: SET_PORTFOLIO,\n            payload: portfolio\n        })\n    }\n\n    const { bonds, filter, portfolio } = state;\n\n    return (\n        <MoexBondsContext.Provider value={{\n            bonds, filter, portfolio,\n            getBonds, setFilter, setPortfolio\n        }}>\n            {children}\n        </MoexBondsContext.Provider>\n    )\n}\n","import React from 'react'\nimport { TableCell, TableRow } from '@material-ui/core';\n\nexport const BondTableRow = (props) => {\n    const { row, columns } = props;\n\n    return (\n        <TableRow hover>\n            {columns.map(col => \n                <TableCell \n                    key={col.id}    \n                    align={col.numeric ? 'right' : 'left'}\n                >\n                    {col.template && typeof(col.template) == 'function' ? col.template(row) : row[col.id]}\n                </TableCell>\n            )}\n        </TableRow>\n    )\n}\n","import React from 'react'\nimport { TableHead, TableRow, TableCell, TableSortLabel } from '@material-ui/core'\n\nexport const BondTableHead = (props) => {\n    const { classes, columns, order, orderBy, onRequestSort } = props;\n    const createSortHandler = (property) => (event) => {\n      onRequestSort(event, property);\n    };    \n    return (\n        <TableHead>\n            <TableRow>\n                {columns.map((headCell) => (\n                    <TableCell\n                        key={headCell.id}\n                        align={headCell.numeric ? 'right' : 'left'}\n                        padding={headCell.disablePadding ? 'none' : 'default'}\n                        sortDirection={orderBy === headCell.id ? order : false}\n                    >\n                        <TableSortLabel\n                            active={orderBy === headCell.id}\n                            direction={orderBy === headCell.id ? order : 'asc'}\n                            onClick={createSortHandler(headCell.id)}\n                        >\n                            {headCell.label}\n                            {orderBy === headCell.id ? (\n                                <span className={classes.visuallyHidden}>\n                                    {order === 'desc' ? 'sorted descending' : 'sorted ascending'}\n                                </span>\n                            ) : null}\n                        </TableSortLabel>\n                    </TableCell>\n                ))}\n            </TableRow>\n        </TableHead>\n    )\n}\n","export const columns = [\n    { id: 'name', numeric: false, disablePadding: true, label: 'Название' },\n    { id: 'value', numeric: true, disablePadding: true, label: 'Номинал' },\n    { id: 'price', numeric: true, disablePadding: false, label: 'Тек.Цена' },\n    { id: 'expireDate', numeric: false, disablePadding: false, label: 'Погашение' },\n    { id: 'couponPeriod', numeric: true, disablePadding: true, label: 'Периодичность'},\n    { id: 'coupon', numeric: true, disablePadding: false, label: 'Купон' },\n    { id: 'couponPercent', numeric: true, disablePadding: false, label: 'Доходность' }\n];","export function descendingComparator(a, b, orderBy) {\n    if (b[orderBy] < a[orderBy]) {\n      return -1;\n    }\n    if (b[orderBy] > a[orderBy]) {\n      return 1;\n    }\n    return 0;\n}\n  \nexport function getComparator(order, orderBy) {\n    return order === 'desc'\n      ? (a, b) => descendingComparator(a, b, orderBy)\n      : (a, b) => -descendingComparator(a, b, orderBy);\n}\n  \nexport function stableSort(array, comparator) {\n    const stabilizedThis = array.map((el, index) => [el, index]);\n    stabilizedThis.sort((a, b) => {\n      const order = comparator(a[0], b[0]);\n      if (order !== 0) return order;\n      return a[1] - b[1];\n    });\n    return stabilizedThis.map((el) => el[0]);\n}","import { makeStyles } from '@material-ui/core/styles';\n\nexport const useStyles = makeStyles((theme) => ({\n    root: {\n      width: '100%',\n    },\n    paper: {\n      width: '100%',\n      marginBottom: theme.spacing(2),\n    },\n    table: {\n      minWidth: 750,\n    },\n    visuallyHidden: {\n      border: 0,\n      clip: 'rect(0 0 0 0)',\n      height: 1,\n      margin: -1,\n      overflow: 'hidden',\n      padding: 0,\n      position: 'absolute',\n      top: 20,\n      width: 1,\n    },\n}));","import React from 'react'\nimport { Table, TableContainer, TableBody, Paper, TablePagination } from '@material-ui/core'\nimport { BondTableRow } from './BondTableRow'\nimport { BondTableHead } from './BondTableHead'\nimport { columns } from './Columns';\nimport { getComparator, stableSort } from './SortUtils';\nimport { useStyles } from './StyleUtils';\n\nexport const BondsTable = (props) => {\n    const classes = useStyles();\n    const [order, setOrder] = React.useState('asc');\n    const [orderBy, setOrderBy] = React.useState('calories');\n    const [page, setPage] = React.useState(0);\n    const [rowsPerPage, setRowsPerPage] = React.useState(10);\n    const rows = props.bonds;\n\n    const handleRequestSort = (event, property) => {\n        const isAsc = orderBy === property && order === 'asc';\n        setOrder(isAsc ? 'desc' : 'asc');\n        setOrderBy(property);\n    };\n    \n    const handleChangePage = (event, newPage) => {\n        setPage(newPage);\n    };\n    \n    const handleChangeRowsPerPage = (event) => {\n        setRowsPerPage(parseInt(event.target.value, 10));\n        setPage(0);\n    };\n    \n    return (\n        <React.Fragment>\n            <TableContainer>\n                <Table size='small'>\n                    <BondTableHead\n                        classes={classes}\n                        columns={props.columns || columns}\n                        order={order}\n                        orderBy={orderBy}\n                        onRequestSort={handleRequestSort}\n                        rowCount={rows.length}\n                    />\n                    <TableBody>\n                        {stableSort(rows, getComparator(order, orderBy))\n                            .slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage)\n                            .map(row => {\n                                return <BondTableRow\n                                    key={row.name}\n                                    row={row}\n                                    columns={props.columns || columns}\n                                />\n                            })\n                        }\n                    </TableBody>\n                </Table>\n            </TableContainer>\n            <TablePagination\n                rowsPerPageOptions={[10, 15, 20, 25, 30]}\n                component=\"div\"\n                count={rows.length}\n                rowsPerPage={rowsPerPage}\n                page={page}\n                onChangePage={handleChangePage}\n                onChangeRowsPerPage={handleChangeRowsPerPage}\n            />\n        </React.Fragment>\n    )\n}\n","import React, { useContext } from 'react'\nimport { MoexBondsContext } from '../../context/MoexBondsContext'\nimport { Link } from '@material-ui/core'\nimport { BondsTable } from '../BondsTable/BondsTable'\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\nimport './Bonds.scss';\n\nexport const Bonds = () => {\n    \n    const { bonds, portfolio, setPortfolio } = useContext(MoexBondsContext);\n\n    const addBondToPortfolio = (bond) => {\n        const modifiedPortfolio = portfolio.concat();\n        const portfolioItem = modifiedPortfolio.filter(p => p.bond.isin == bond.isin);\n\n        if (portfolioItem.length) {\n            portfolioItem[0].count++;\n        } else {\n            modifiedPortfolio.push({ count: 1, bond: bond });\n        }\n        \n        setPortfolio(modifiedPortfolio);\n    }\n\n    // TODO: убрать валюту, перенести в фильтры\n\n    // TODO: объединить столбцы \"погашение\", \"выплаты\", \"купонов\", \"период\" в 1 компонент, \n    //       который графически показывает выплаты в виде ячеек с буквой месяца, \n    //       и шкалой от 1 до макс. купонов\n\n    // TODO: сделать стили более сжатыми, чтобы помещалось больше колонок и строк\n\n    // TODO: добавить ссылку рядом с именем на https://www.moex.com/ru/issue.aspx?board=TQOD&code=XS0088543193\n\n    // TODO: индикатор, что облигация уже в портфеле\n\n    // TODO: поиск по имени и isin\n\n    return (\n        <div>\n            <BondsTable bonds={bonds} columns={[\n                { id: 'name', numeric: false, disablePadding: false, label: 'Название',\n                    template: (bond) => (\n                        <Link\n                            target='_blank'\n                            href={`https://www.moex.com/ru/issue.aspx?board=${bond.board}&code=${bond.isin}`}\n                        >\n                            {bond.name}\n                        </Link> \n                    )\n                },\n                //{ id: 'currency', numeric: true, disablePadding: true, label: 'Валюта' },\n                //{ id: 'value', numeric: true, disablePadding: true, label: 'Номинал' },\n                { id: 'expireDate', numeric: true, disablePadding: false, label: 'Погашение' },\n                //{ id: 'months', numeric: true, disablePadding: false, label: 'Выплаты' },\n                { id: 'couponCount', numeric: true, disablePadding: false, label: 'Купонов' },\n                { id: 'couponPeriod', numeric: true, disablePadding: false, label: 'Период' },\n                { id: 'coupon', numeric: true, disablePadding: false, label: 'Купон' },\n                { id: 'couponAccumulated', numeric: true, disablePadding: false, label: 'НКД' },\n                { id: 'price', numeric: true, disablePadding: false, label: 'Тек.Цена' },                \n                { id: 'couponPercent', numeric: true, disablePadding: false, label: 'Доходность' },\n                { id: 'isin', numeric: false, disablePadding: false, \n                    template: (bond) => (\n                        <Link\n                            className='add-link' \n                            onClick={() => addBondToPortfolio(bond)}\n                        >\n                            <AddCircleIcon/>\n                        </Link>\n                    )\n                }\n            ]} />\n        </div>\n    )\n}\n","export const months = [\n    'Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн', 'Июл', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек'\n];","import React, { useContext } from 'react'\nimport { Button, Select, FormControl, InputLabel, MenuItem } from '@material-ui/core'\nimport { MoexBondsContext } from '../../context/MoexBondsContext';\nimport { months } from '../../common/months';\nimport './Filter.scss';\n\nexport const Filter = () => {\n\n    const { filter, setFilter } = useContext(MoexBondsContext);\n    \n    const clearFilter = () => {\n        const modifiedFilter = { ...filter };\n        modifiedFilter.month = null;\n        setFilter(modifiedFilter);\n    }\n\n    const changeMonth = (event) => {\n        const month = event.target.value;\n        const modifiedFilter = { ...filter };\n        modifiedFilter.month = month;\n        setFilter(modifiedFilter);\n    }\n\n\n    // TODO: добавить валюты\n\n    // TODO: сделать фильтр по экспирации в виде слайдера\n\n    // TODO: сделать фильтр по доходности в виде слайдера\n\n    return (\n        <div className=\"filter\">\n            <FormControl className='select-month'>\n                <InputLabel id='filter-month'>Месяц выплат</InputLabel>\n                <Select\n                    labelId='filter-month'\n                    value={filter.month || 0}\n                    onChange={changeMonth}\n                >\n                    <MenuItem value={0}>Все</MenuItem>\n                    {months.map((month, index) => (\n                        <MenuItem\n                            value={index + 1}\n                            key={index + 1}\n                        >\n                            {month}\n                        </MenuItem>\n                    ))}\n                </Select>\n            </FormControl>\n        </div>\n    )\n}\n","import React from 'react'\nimport { TextField, Link } from '@material-ui/core';\nimport RemoveCircleOutlineIcon from '@material-ui/icons/RemoveCircleOutline';\nimport './PortfolioItem.scss';\n\nexport const PortfolioItem = ({ bond, count, changeCount, removeItem }) => {\n\n    const calculateCost = (bond, count) => {\n        const value = parseFloat(bond.value);\n        const price = parseFloat(bond.price);\n        const couponAccumulated = parseFloat(bond.couponAccumulated);\n        return Math.round(value * price * count / 100) + couponAccumulated * count;\n    }\n\n    return (\n        <div className=\"bond\">\n            <div className=\"name\">\n                <Link\n                    className='remove-item' \n                    onClick={() => removeItem(bond)}>\n                    <RemoveCircleOutlineIcon />\n                </Link>\n                {bond.name} ({bond.expireDate})\n            </div>\n            <div className=\"coupon\">\n                {bond.couponPercent}%\n            </div>\n            <div className=\"count\">\n                <TextField\n                    type=\"number\"\n                    value={count}\n                    onChange={(event) => changeCount(event, bond)}\n                />\n            </div>\n            <div className=\"cost\">\n                {calculateCost(bond, count)} р.\n            </div>\n        </div>\n    )\n}\n","import React, { useContext } from 'react'\nimport { MoexBondsContext } from '../../context/MoexBondsContext';\nimport { PortfolioItem } from '../PortfolioItem/PortfolioItem';\nimport './Portfolio.scss';\n\nexport const Portfolio = (props) => {\n    const { portfolio, setPortfolio } = useContext(MoexBondsContext);\n\n    const changeCount = (event, bond) => {\n        const changedPortfolio = portfolio.concat();\n        const portfolioBond = changedPortfolio.filter(p => p.bond.isin == bond.isin)[0];\n        portfolioBond.count = event.target.value;\n        setPortfolio(changedPortfolio);\n    }\n\n    const removeItem = (bond) => {\n        const changedPortfolio = portfolio.concat().filter(p => p.bond.isin != bond.isin);\n        setPortfolio(changedPortfolio);\n    }\n\n    const calculateCost = (bond, count) => {\n        const value = parseFloat(bond.value);\n        const price = parseFloat(bond.price);\n        const couponAccumulated = parseFloat(bond.couponAccumulated);\n        return Math.round(value * price * count / 100) + couponAccumulated * count;\n    }\n\n    const calculateTotal = () => {\n        let total = 0;\n        portfolio.map(p => total += calculateCost(p.bond, p.count));\n        return Math.round(total * 100) / 100;\n    }\n\n    // TODO: удалить из портфеля\n    \n    // TODO: более компактный стиль\n\n    // TODO: отображать фоновым баром процент от общего портфеля\n\n    // TODO: при клике или наведении на бар, подсвечивать облигации в этом баре\n\n    // TODO: сделать возможность поиска при клике\n\n    return (\n        <div className=\"portfolio\">\n            <h2>Портфель</h2>\n\n            {!!portfolio.length \n                && <div className=\"list\">\n                    {portfolio.map(item => (\n                        <PortfolioItem \n                            key={item.bond.isin} \n                            bond={item.bond} \n                            count={item.count} \n                            changeCount={changeCount}\n                            removeItem={removeItem}\n                        />\n                    ))}\n                    <div className=\"total\">\n                        {calculateTotal()} р.\n                    </div>\n                </div>\n            }\n\n            {!portfolio.length \n                && <p className=\"empty\">Здесь пока пусто</p>\n            }\n        </div>\n    )\n}\n","import React from 'react'\nimport { useContext } from 'react';\nimport { MoexBondsContext } from '../../context/MoexBondsContext';\nimport { months } from '../../common/months';\nimport './Chart.scss';\n\nexport const Chart = () => {\n    const { portfolio } = useContext(MoexBondsContext);\n    const portfolioMonths = {};\n    let maxCouponValue = 0;\n    let maxCouponCount = 0;\n\n    const calculateTotalCoupon = (items) => {\n        let total = 0;\n        items.map(item => {\n            total += item.count * parseFloat(item.bond.coupon);\n        });\n        return Math.round(total);\n    }\n\n    const getCouponValue = (monthIndex) => {\n        return portfolioMonths[monthIndex] ? portfolioMonths[monthIndex].coupon : 0;\n    }\n\n    const getBarHeightString = (monthIndex) => {\n        const coupon = getCouponValue(monthIndex);\n        let percent = coupon * 100 / maxCouponValue;\n        if (percent < 8) percent = 8;\n        return percent + '%';\n    }\n\n    const getBarOpacityString = (monthIndex) => {\n        const counts = getCouponCountByMonth(monthIndex);\n        const min = Math.min(...counts);\n        let opacity = min / maxCouponCount * 0.5 + 0.5;\n        // TODO: прозрачность бара в зависимости от экспирации\n        //       это работает не правильно, нужно учитывать дни до экспирации, а не кол-во купонов\n        return `${opacity} `;\n    }\n\n    const getCouponCountByMonth = (monthIndex) => {\n        return portfolioMonths[monthIndex] \n            ? portfolioMonths[monthIndex].items.map(i => i.bond.couponCount) \n            : [];\n    }\n\n    portfolio.map(item => {\n        item.bond.months.map(month => {\n            if (!portfolioMonths[month]) {\n                portfolioMonths[month] = {\n                    items: [],\n                    coupon: 0\n                };\n            }\n            portfolioMonths[month].items.push(item);\n            portfolioMonths[month].coupon = calculateTotalCoupon(portfolioMonths[month].items)\n        })\n    });\n\n    let keys = Object.keys(portfolioMonths);\n    let coupons = keys.map(key => portfolioMonths[key].coupon);\n    // let counts = keys.map(key => {\n    //     let c = getCouponCountByMonth(key)\n    //     return Math.min(...c); // судим о сроке погашения по минимальному в месяце\n    // });\n    maxCouponValue = Math.max(...coupons);\n    //maxCouponCount = Math.max(...counts);\n\n    // TODO: возврат средств от момента вложения до последнего погашения\n\n    return (\n        <div className=\"chart-container\">\n            <h2>Выплаты</h2>\n            <div className=\"chart\">\n                {months.map((month, index) => (\n                    <div\n                        key={month} \n                        className=\"month\" \n                        style={{ \n                            height: getBarHeightString(index + 1),\n                        //opacity: getBarOpacityString(index + 1)\n                        }}\n                    >\n                        <div className=\"price\">{getCouponValue(index + 1)}р</div>\n                        <div className=\"label\">{month}</div>\n                    </div>\n                ))}\n            </div>\n        </div>\n    )\n}\n","import React, { useContext } from 'react'\nimport { MoexBondsContext } from '../../context/MoexBondsContext';\nimport './ChartCumulative.scss';\n\nexport const ChartCumulative = () => {\n    \n    const { portfolio } = useContext(MoexBondsContext);\n\n    const monthDiff = (d1, d2) => {\n        let months;\n        months = (d2.getFullYear() - d1.getFullYear()) * 12;\n        months -= d1.getMonth();\n        months += d2.getMonth();\n        return months <= 0 ? 0 : months;\n    }\n\n    const arraySum = (arr) => {\n        return arr.length ? Math.round(arr.reduce((acc, val) => acc + val) * 100) / 100 : 0;\n    }\n\n    const getHeightString = (ret) => {\n        const max = drawReturns[drawReturns.length - 1];\n        const percent = ret * 100 / max;\n        return percent + '%';\n    }\n\n    const calculateCost = (bond, count) => {\n        const value = parseFloat(bond.value);\n        const price = parseFloat(bond.price);\n        const couponAccumulated = parseFloat(bond.couponAccumulated);\n        return Math.round(value * price * count / 100) + couponAccumulated * count;\n    }\n\n    const calculateTotal = () => {\n        let total = 0;\n        portfolio.map(p => total += calculateCost(p.bond, p.count));\n        return Math.round(total * 100) / 100;\n    }\n\n    const payments = [];\n    let returns = [];\n    const sortedBonds = portfolio\n        .map(p => { return { ...p.bond, count: p.count } })\n        .sort((a, b) => a.expireDate < b.expireDate ? -1 : 1);\n\n    if (sortedBonds.length) {\n        const curDate = new Date();\n        const curMonth = curDate.getMonth() + 1; // starting from 1..12\n        const lastDate = new Date(sortedBonds[sortedBonds.length - 1].expireDate);\n        const months = monthDiff(curDate, lastDate);\n        returns = new Array(months + 1);\n\n        for (let i = 0; i < sortedBonds.length; i++) {\n            const bond = sortedBonds[i];\n            let nextMonths = bond.months.filter(m => m > curMonth);\n            let monthIndex = nextMonths.length ? bond.months.indexOf(nextMonths[0]) : 0;\n            let month = 0;\n            let fromCurrent = bond.months[monthIndex] - curMonth;\n            const monthDelta = bond.months.length > 1 ? bond.months[1] - bond.months[0] : 0;\n\n            for (let j = 0; j < bond.couponCount; j++) {\n\n                month = bond.months[monthIndex];\n                \n                payments.push({ \n                    bond: bond,\n                    month: month,\n                    inMonths: fromCurrent,\n                    type: 'coupon', \n                    value: bond.coupon * bond.count\n                });\n\n                monthIndex++;\n                \n                if (monthIndex >= bond.months.length) {\n                    monthIndex = 0;\n                }\n\n                if (j == bond.couponCount - 1) {\n                    payments.push({ \n                        bond: bond, \n                        month: month, \n                        inMonths: fromCurrent,\n                        type: 'expiration', \n                        value: bond.value * bond.count\n                    });\n                }\n\n                fromCurrent += monthDelta;\n            }\n        }\n        \n        payments.sort((a, b) => a.inMonths < b.inMonths ? -1 : 1);\n\n        for (let m = 0; m < returns.length; m++) {\n            const paymentsFiltered = payments.filter(p => p.inMonths < m + 1);\n            returns[m] = arraySum(paymentsFiltered.map(p => p.value));\n        }\n    }\n\n    const round = (num) => {\n        return Math.round(num * 100) / 100;\n    }\n\n    const portfolioTotal = calculateTotal();\n    const returnTotal = returns[returns.length - 1] || 0;\n    const profit = round(returnTotal - portfolioTotal);\n    const profitPercent = profit > 0 ? round((returnTotal / portfolioTotal) * 100) : 0;\n    const drawLimit = 100;\n    const drawReturns = returns.length > drawLimit ? returns.concat().splice(returns.length - drawLimit) : returns;\n    const yearsCount = round(returns.length/12);\n    const annualProfit = portfolioTotal > 0 ? round(Math.log(returnTotal / portfolioTotal) / yearsCount * 100) : 0;\n\n    return (\n        <div className='chart-cumulative-container'>\n            <h2>Возврат</h2>\n            <p>\n                Через {returns.length} месяцев возврат средств составит {returnTotal}р. Прибыль {profit}р. ({profitPercent}%).\n                Или через {yearsCount} лет {annualProfit}% годовых.\n            </p>        \n            <div className='chart-cumulative'>\n                {drawReturns.map((r, index) => \n                    <div\n                        key={index}\n                        className='chart-cumulative-bar'\n                        style={{ height: getHeightString(r) }}\n                    >\n                        <div className='return'>{r}</div>\n                        <div className='month'>{index + 1}</div>\n                    </div>\n                )}\n            </div>\n        </div>\n    )\n}\n","import React, { useContext, useEffect } from 'react';\nimport { MoexBondsContext } from '../context/MoexBondsContext';\nimport { Bonds } from '../components/Bonds/Bonds';\nimport { Filter } from '../components/Filter/Filter';\nimport { Portfolio } from '../components/Portfolio/Portfolio';\nimport { Chart } from '../components/Chart/Chart';\nimport './Home.scss';\nimport { ChartCumulative } from '../components/ChartCumulative/ChartCumulative';\n\nexport const Home = () => {\n\n    const { getBonds } = useContext(MoexBondsContext);\n\n    useEffect(() => {\n        getBonds();\n    }, []);\n\n    return (\n        <div className=\"container\">\n            <div className=\"portfolio-chart\">\n                <Chart />\n            </div>\n            <div className=\"returns-chart\">\n                <ChartCumulative />\n            </div>\n            <div className=\"bonds-filter\">\n                <Filter />\n            </div>\n            <div className=\"bonds-list\">\n                <Bonds />\n            </div>\n            <div className=\"portfolio-list\">\n                <Portfolio />\n            </div>\n        </div>\n    )\n}\n","import React from 'react';\nimport './App.scss';\nimport { MoexBondsProvider } from './context/MoexBondsProvider';\nimport { Home } from './pages/Home';\n\nfunction App() {\n  return (\n    <MoexBondsProvider>\n       <Home />\n    </MoexBondsProvider>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}